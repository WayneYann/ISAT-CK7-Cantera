# Author: Varun Hiremath <vh63@cornell.edu>
# Date: Thu, 29 Nov 2012 15:32:19 -0600

Parallel PaSR: Partially-Stirred Reactor
========================================
A 'pasr_multi' test case is provided here to demonstrate the working
of PaSR in parallel on multiple cores using the x2f_mpi library.

pasr_multi Executable
---------------------
Build and copy the pasr_multi executable from the x2f_mpi source
directory into the 'test_case' directory provided here which contains
all the required input files.

Input Files
-----------
chem.bin   - chemkin mechanism interface file
ci.nml     - chemistry interface (isat-ck) input file
isat_1.nml - isat input file
pasr.nml   - pasr input file
rxn.nml    - pasr_multi/x2f_mpi input file
streams.in - pasr streams input file

Chemkin Input File: chem.bin
----------------------------
To run pasr_multi, the chemkin mechanism input file 'chem.bin' should
be provided. For a given chemkin mechanism file (chem.inp) and the
thermodynamic data file (therm.dat), the chem.bin file can be
generated by running the 'ckinterp' executable. Both 'chem.inp' and
'therm.dat' files should be present in the same folder. Check the
'chem.out' output file for errors.

Input Parameters
----------------
Most of the input parameters for this test case can be set similar to
the PaSR test case. The additional input parameters pertinent to this
case are:

== pasr.nml ==
ng_pasr  - no. of cores for the parallel run
	
== rxn.nml ==
mode  : x2f_mpi parallel mode
	= 1 PLP
	= 2 URAN
qt    : quick try
adpat : = 1 use adaptive mode; = 0 do not use adaptive mode


Streams Info: streams.in
------------------------
streams.in provides information about the ISAT mode to be used and the
inflowing stream composition. Read the comments in streams.in file.

Example Test Case
-----------------
The example test case provided in the 'test_case' directory is set up
to run methane/air non-premixed combustion in the PaSR. The chemistry
is represented by a 17-species skeletal mechanism (see chem.inp). The
test case is setup to run on 32 cores (set in pasr.nml).

There are three inflowing streams into the PaSR: PILOT, AIR and FUEL
(specified in the streams.in input file).

The variable 'MODECI' in the streams.in file controls the mode used in
PaSR and ISAT to represent the thermochemistry. The following modes
are available (as listed in the streams.in file):

! specify MODECI: the mode of thermochemistry to be used in ISAT
!        = 1 or CONST_PROPERTY     - inert, constant-density flow
!        = 2 or MIXTURE_FRACTION   - mixture fraction formulation
!        = 3 or PROGRESS_VARIABLE  - reaction progress variable formulation
!        = 4                       - not supported yet
!        = 5                       - not supported yet
!        = 6 or DIRECT_INTEGRATION - CHEMKIN/direct integration
!        = 7 or ISAT_DI            - CHEMKIN/ISAT
!        = 8 or RCCE               - CHEMKIN/ISAT/RCCE
!        = 9 or ICE_PIC            - CHEMKIN/ISAT/ICE_PIC

To use the RCCE or ICE-PIC (dimension reduction) modes, the
represented species must be specified in the last section of
streams.in file (as explained there in the comments).

Job Script
----------
An example job script 'job.sh' is provided to run the test case
in parallel on 32 cores on the TACC Ranger cluster.

Expected Output
---------------
The output files generated from the pasr_multi run on Ranger are
included in the 'test_case_output' directory.
