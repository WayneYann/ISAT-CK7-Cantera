% Author: Varun Hiremath <vh63@cornell.edu>
% Date: Wed, 28 Nov 2012 20:03:40 -0600

PaSR: Partially-Stirred Reactor
===============================
This README file explains the overall working of the PaSR (provided
with ISAT-CK7) and the various input files used to control PaSR and
ISAT-CK7.

Chemistry Modes
---------------
ISAT-CK7 provides different modes for representing chemistry.

The variable 'MODECI' in the streams.in input file controls the mode
used in PaSR and ISAT to represent the thermochemistry. The following
modes are available (as listed in the streams.in file):

! specify MODECI: the mode of thermochemistry to be used in ISAT
!        = 1 or CONST_PROPERTY     - inert, constant-density flow
!        = 2 or MIXTURE_FRACTION   - mixture fraction formulation
!        = 3 or PROGRESS_VARIABLE  - reaction progress variable formulation
!        = 4                       - not supported yet
!        = 5                       - not supported yet
!        = 6 or DIRECT_INTEGRATION - CHEMKIN/direct integration
!        = 7 or ISAT_DI            - CHEMKIN/ISAT
!        = 8 or RCCE               - CHEMKIN/ISAT/RCCE
!        = 9 or ICE_PIC            - CHEMKIN/ISAT/ICE_PIC

To use the RCCE or ICE-PIC (dimension reduction) modes, the
represented species must be specified in the last section of
streams.in file (as explained there in the comments).

Dependencies
------------
The modes 1,2,3 can be used with the provided ISAT-CK7 source
code without the need of any third-party libraries. However, to use
modes 6,7,8,9 you will need to link to the third-party libraries like
CHEMKIN and ADIFOR as described in the README_dependencies.txt file
included in the ISAT-CK7 source directory.

Example Test Cases
------------------
In the 'test_case' directory, we provide example test files for the
following modes:

1/ test_1  : test case for mode = 1
2/ test_23 : test case for modes 2 and 3
3/ test_67 : test case for modes 6 and 7
4/ test_89 : test case for modes 8 and 9

The test cases for modes 6,7,8,9 are set up to run ethylene/air
non-premixed combustion in the PaSR. The chemistry is represented by a
38-species skeletal mechanism (see chem.inp).

There are three inflowing streams into the PaSR: PILOT, FUEL and
COFLOW (with compositions similar to inflowing streams for the Sandia
Flame D) which are specified in the streams.in input file.

PaSR Executable
---------------
Build and copy the PaSR executable from the ISAT-CK7 source directory
into the test case that you wish to run. The input files required to
run each test case are provided in the respective test case directory.

Expected Output
---------------
The output files generated from each of the test cases (when ISAT-CK7
is built with all the required external libraries) are included in the
'test_case_output' directory.

Input Files
-----------
The following input files are used to run PaSR. A brief description
about each file is provided below.

chem.bin   - chemkin mechanism interface file
ci.nml     - chemistry interface (isat-ck) input file
isat_1.nml - isat input file
pasr.nml   - pasr input file
streams.in - pasr streams input file

Chemkin Input File: chem.bin
----------------------------
This file is required only in modes 6,7,8,9.

To run PaSR in these modes, the chemkin mechanism input file
'chem.bin' should be provided. For a given chemkin mechanism file
(chem.inp) and the thermodynamic data file (therm.dat), the chem.bin
file can be generated by running the 'ckinterp' executable. Both
'chem.inp' and 'therm.dat' files should be present in the same
directory. Check the 'chem.out' output file for errors.

Using Reduced Mechanisms
------------------------
If you are using a detailed or skeletal mechanism then you may skip
this section.

To use a reduced mechanism, the routine corresponding to 'ckwyp'
should be called from 'usrate' routine (see usrate.f source file in
the ISAT-CK7/PaSR source code directory), and 'us_rate=1' should be
set in the 'ci.nml' input file. The reduced mechanism 'usrate' routine
source file name should be included in the ISAT-CK7/PaSR/SOURCES.txt
file for compiling and linking it with the PaSR code.

Chemistry Interface Input File: ci.nml
--------------------------------------
Apart from the 'us_rate' variable, nothing else needs to be changed.
'us_rate=1' uses the routine specified in 'usrate' routine to compute
the reaction rates, else the default chemkin 'ckwyp' routine is used.

ISAT Input File: isat_1.nml
---------------------------
The isat error tolerance can be set using 'etola' and the table size
can be set using 'stomby'.

PaSR Input File: pasr.nml
-------------------------
pasr.nml can be used to set the following PaSR variables:

anres  - # of residence times for simulation
tres   - residence time
tmix   - mixing time (usually taken as 0.1*tres)
tpair  - pairing time (usually taken as 0.1*tres)
screen - output to screen (if .true.) else save to pasr.txt

Streams Info: streams.in
------------------------
streams.in provides information about the ISAT-CK7 mode to be used for
representing chemistry and the composition of the inflowing
streams. Read the comments in streams.in file for more details.

